<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <title>
      Moving a PHP project to Composer &middot; Rémy G
  </title>
  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />
  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />
  <!-- Additional head bits without overriding original head -->
</head>
  <body class="rg-post">
    <div id="sidebar">
  <img src="https://d1u9a15udaub9r.cloudfront.net/profile-cropped.jpg" id="author-picture" />
  <header>
    <div class="site-title">
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        Rémy G
    </div>
    <p class="lead">Blog of a software developer
</p>
  </header>
  <nav id="sidebar-nav-links">
    <a class="home-link "
        href="/">Home</a>
  <a class="page-link" href="/blog/">Blog</a>
    <a class="page-link "
        href="/projects/">Projects</a>
  <!-- Optional additional links to insert in sidebar nav -->
<a class="page-link" href="/about/">About Me</a>
<a class="page-link" href="/contact/">Contact</a>
</nav>
  <nav id="sidebar-icon-links">
  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags/">
      <svg fill="#000000" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Tags"
       href="/search/">
      <svg fill="#000000" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  <!-- Optional additional links to insert for icons links -->
<a id="github-link"
   class="icon"
   title="Github" aria-label="Tags"
   href="https://github.com/remyg">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>
</a>
<a id="twitter-link"
   class="icon"
   title="Twitter" aria-label="Tags"
   href="https://twitter.com/remygardette">
  <svg viewbox="0 0 512 512"><path d="M419.6 168.6c-11.7 5.2-24.2 8.7-37.4 10.2 13.4-8.1 23.8-20.8 28.6-36 -12.6 7.5-26.5 12.9-41.3 15.8 -11.9-12.6-28.8-20.6-47.5-20.6 -42 0-72.9 39.2-63.4 79.9 -54.1-2.7-102.1-28.6-134.2-68 -17 29.2-8.8 67.5 20.1 86.9 -10.7-0.3-20.7-3.3-29.5-8.1 -0.7 30.2 20.9 58.4 52.2 64.6 -9.2 2.5-19.2 3.1-29.4 1.1 8.3 25.9 32.3 44.7 60.8 45.2 -27.4 21.4-61.8 31-96.4 27 28.8 18.5 63 29.2 99.8 29.2 120.8 0 189.1-102.1 185-193.6C399.9 193.1 410.9 181.7 419.6 168.6z"/></svg>
</a>
</nav>
  <p>
  &copy; 2018.
  <a href="/LICENSE.md">MIT License.</a>
</p>
</div>
    <main class="container">
      <header>
  <h1 class="post-title">Moving a PHP project to Composer</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">11 Sep 2014</span>
  <span class="post-categories">
      &bull;
        blog
      &bull;
        <a href="/category/development/">
          Development
        </a>
  </span>
</div>
  <div class="post-body">
    <p>A few months ago, I’ve discovered <a href="https://getcomposer.org/" title="Composer">Composer</a>, which is a dependency manager for PHP (you can compare it to Maven, for Java). With Composer, you can simply checkout the main project, and install the dependencies.</p>
<p>The transition to a Composer project is very easy, so I decided to start using Composer in my <a href="https://github.com/RemyG/ComicsCalendar" title="ComicsCalendar on GitHub">ComicsCalendar</a> project. In this post, I’ll explain how you can migrate to Composer for a very simple project (in this case, using <a href="http://propelorm.org/Propel/" title="Propel - The Fast PHP5 ORM">PropelORM</a> to access your databases).</p>
<!--more-->
<p>The project structure at the start of this work is:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- comicslist
	- application
		+ build
		+ config
		+ controllers
		+ helper
		- plugins
			+ propel
			  recaptchalib.php
		+ views
		  build.properties
		  propel-gen
		  runtime-conf.xml
		  schema.xml
	+ static
	+ system
	  .gitignore
	  .gitmodules
	  .htaccess
	  index.php
</code></pre></div></div>
<h2 id="1-install-composer">1. Install Composer</h2>
<p>It’s really easy to install Composer. Just follow the instructions on <a href="https://getcomposer.org/doc/00-intro.md#installation-nix" title="Composer - Installation - *nix">the official documentation</a>.</p>
<p>In the following commands, I’ll assume that you’ve installed Composer so you can run it with:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ composer
</code></pre></div></div>
<h2 id="2-create-the-setup-file">2. Create the setup file</h2>
<p>Each Composer project requires a <code class="highlighter-rouge">composer.json</code> file. This file (equivalent to the <code class="highlighter-rouge">pom.xml</code> file for Maven), contains a list or the project dependencies (and lots of other things I won’t mention here).</p>
<p>Create a <code class="highlighter-rouge">composer.json</code> file at the root of your project:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
	"require": {
		"propel/propel1": "1.7.1"
	}
}
</code></pre></div></div>
<p>As you can guess, this will install version 1.7.1 of PropelORM.</p>
<p>This is the only dependency you will install right now (Composer automatically installs the dependencies of your dependencies).</p>
<h2 id="3-install-the-dependencies">3. Install the dependencies</h2>
<p>To install the dependencies, run from the project root:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ composer install
</code></pre></div></div>
<p>This command created the <code class="highlighter-rouge">vendor</code> folder (if it doesn’t exist), and the <code class="highlighter-rouge">vendor/autoload.php</code> file, which contains the list of files to include into the project.</p>
<h2 id="4-include-the-dependencies-in-the-project">4. Include the dependencies in the project</h2>
<p>The work is almost done, you just need to include the dependencies in your project. As I just explained, the file <code class="highlighter-rouge">vendor/autoload.php</code> contains the dependencies you need to include.</p>
<p>Just include this file in any “global” PHP file:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">require_once</span><span class="p">(</span><span class="s1">'vendor/autoload.php'</span><span class="p">);</span>
</code></pre></div></div>
<h2 id="5-clean-up-the-project">5. Clean-up the project</h2>
<p>The last action is to clean-up the project from the previous Propel installation. Remove the <code class="highlighter-rouge">application/plugins/propel</code> folder (which contains the old Propel classes), the <code class="highlighter-rouge">.gitmodules</code> file (which contains references to the Git sub-modules), as well as the reference to the main Propel script (which is now referenced in the <code class="highlighter-rouge">autoload.php</code> file).</p>
<h2 id="6-configure-git">6. Configure Git</h2>
<p>If you’re using Git to track your sources, you’ll need to add a few changes to your project.</p>
<p>Add a <code class="highlighter-rouge">.gitignore</code> file at the root of the <code class="highlighter-rouge">vendor</code> folder, containing:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*
!.gitignore
</code></pre></div></div>
<p>This will allow you to commit the <code class="highlighter-rouge">vendor</code> folder, without any sub-folders (those will be re-created when running <code class="highlighter-rouge">$ composer install</code>).</p>
<p>You also need to add the <code class="highlighter-rouge">composer.json</code> and <code class="highlighter-rouge">composer.lock</code> files. The <code class="highlighter-rouge">composer.lock</code> file contains the actual versions of all your dependencies (since you can specify ranges in the versions), so someone who installs the dependencies will have the same versions as you do.</p>
<hr />
<p>You’re now ready to keep using PropelORM, and add new dependencies that could help you (yes Monolog, I’m looking at you…).</p>
<div class="post-tags">
    <a href="/tags/#composer">
      <span class="icon">
        <svg fill="#000000" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Composer</span>
    </a>
    <a href="/tags/#php">
      <span class="icon">
        <svg fill="#000000" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">PHP</span>
    </a>
    <a href="/tags/#propelorm">
      <span class="icon">
        <svg fill="#000000" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">PropelORM</span>
    </a>
</div>
  </div>
  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
      <li>
        <h3>
          <a href="/blog/2018/07/29/nginx-reverse-proxy/">
            NGINX Reverse Proxy
            <small>29 Jul 2018</small>
          </a>
        </h3>
      </li>
      <li>
        <h3>
          <a href="/blog/2018/05/13/sending-temperature-data-from-esp8266-to-mqtt/">
            Sending temperature data from an ESP8266 to MQTT
            <small>13 May 2018</small>
          </a>
        </h3>
      </li>
      <li>
        <h3>
          <a href="/blog/2018/05/01/esp8266-temperature-display/">
            ESP8266 Temperature Display
            <small>01 May 2018</small>
          </a>
        </h3>
      </li>
  </ul>
</section>
</div>
    </main>
    <!-- Optional footer content -->
  </body>
</html>
